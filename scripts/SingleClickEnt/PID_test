import qt
import numpy as np
from matplotlib import pyplot as plt
import msvcrt

# variables
k = 50
A = 100
omega = 10
t_wait = 1e-6
t = 0
teta = 0
V_out = 0

# definitions


# plot
plt.ion()

adwin.start_PID_fiberstretcher(setpoint=0, delay=10)

while True:
    if (msvcrt.kbhit() and (msvcrt.getch() == 'q')):            # To stop iteration
        break


    V_out = adwin.get_PID_fiberstretcher_var('PID_V_out')       # Get output PID

    teta = V_out*k
    s = A*sin(omega*t + teta)                                   # Calculate signal

    plt.scatter(t, s)                                           # plot

    adwin.set_PID_fiberstretcher_var('PID_input', s)            # Signal into PID

    t = t+t_wait                                                # new time for next iteration

    qt.msleep(t_wait)